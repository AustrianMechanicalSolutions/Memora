<aside class="sidebar">
  <div class="sidebar-header">
    <a routerLink="/home" routerLinkActive="active" class="nav-link logo-link">
      <img src="/memora-logo.png" alt="Memora Logo" class="logo-icon" (error)="$event.target.onerror=null; $event.target.src='/memora-logo.ico'" />
      <span class="logo-fallback">üè†</span>
      <span class="label">Your Memora</span>
    </a>
  </div>

  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a routerLink="/groups" routerLinkActive="active" class="nav-link">
          <span class="icon">‚ßâ</span>
          <span class="label">Groups</span>
        </a>
        <ul class="groups-sublist" *ngIf="groups.length > 0">
          <li class="group-subitem" *ngFor="let group of groups">
            
            <!-- GROUP LINK -->
            <a [routerLink]="['/groups', group.id]"
              routerLinkActive="active"
              class="group-link">
              <span class="group-indicator">‚îî</span>
              <span class="group-name">{{ group.name }}</span>
            </a>

            <!-- ADMIN SUBMENU (only when inside that group) -->
            <ul class="groups-sublist"
                *ngIf="router.url.startsWith('/groups/' + group.id + '/admin')">
              
              <li class="group-subitem">
                <a [routerLink]="['/groups', group.id, 'admin', 'dashboard']"
                  routerLinkActive="active"
                  class="group-link">
                  <span class="group-indicator">‚îú</span>
                  <span class="group-name">Dashboard</span>
                </a>
              </li>

              <li class="group-subitem">
                <a [routerLink]="['/groups', group.id, 'admin', 'members']"
                  routerLinkActive="active"
                  class="group-link">
                  <span class="group-indicator">‚îú</span>
                  <span class="group-name">Members</span>
                </a>
              </li>

              <li class="group-subitem">
                <a [routerLink]="['/groups', group.id, 'admin', 'memories']"
                  routerLinkActive="active"
                  class="group-link">
                  <span class="group-indicator">‚îú</span>
                  <span class="group-name">Memories</span>
                </a>
              </li>

              <li class="group-subitem">
                <a [routerLink]="['/groups', group.id, 'admin', 'albums']"
                  routerLinkActive="active"
                  class="group-link">
                  <span class="group-indicator">‚îú</span>
                  <span class="group-name">Albums</span>
                </a>
              </li>

              <li class="group-subitem">
                <a [routerLink]="['/groups', group.id, 'admin', 'settings']"
                  routerLinkActive="active"
                  class="group-link">
                  <span class="group-indicator">‚îî</span>
                  <span class="group-name">Settings</span>
                </a>
              </li>

            </ul>

          </li>
        </ul>
      </li>
    </ul>
  </nav>

  <div class="sidebar-footer">
    <button class="theme-toggle" type="button" (click)="toggleTheme()">
      <span class="label">Theme</span>
      <span class="switch" [class.on]="themeMode === 'dark'">
        <span class="switch-thumb"></span>
      </span>
    </button>
    <div class="stats-item">
      <a routerLink="/stats" routerLinkActive="active-icon" class="user-button" title="View Stats">
        <img 
          *ngIf="userProfileImageUrl" 
          [src]="userProfileImageUrl" 
          alt="Profile" 
          class="user-avatar"
        />
        <div *ngIf="!userProfileImageUrl" class="user-avatar-placeholder">
          üë§
        </div>
        <span class="label">{{ currentUser?.displayName }}</span>
      </a>
    </div>
  </div>
</aside>
